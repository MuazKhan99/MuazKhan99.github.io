<!-- <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin</title>
    <link rel="stylesheet" href="vet.css">
    <link href="adminUsers.html" rel="import" />
    <div w3-include-HTML="adminUsers.html"></div>
    
  </head>


    <table class="container">
      <thead>
        <div class="header">Animals</div>
        <br>
        <tr>
          <th><h1>Pet Name</h1></th>
          <th><h1>Reason</h1></th>
          <th><h1>Pet Owner</h1></th>
          <th><h1>Date</h1></th>
        </tr>
      </thead>
      <tbody id="myData"></tbody>
      <tbody></tbody>
    </table>

    <script>
      fetch("http://localhost:3000/api/booking/")
        .then((res) => res.text())
        .then((out) => {
          let jsonData = JSON.parse(out);
          for (let time of jsonData) {
            myData.innerHTML +=
              "<tr><td>" +
              time.pet +
              "</td>" +
              "<td align='right'>" +
              time.reason +
              "</td>" +
              "<td align='right'>" +
              time.fullName +
              "</td>" +
              "<td align='right'>" +
              time.time;
          }
        })
        .catch((err) => console.error(err));

      const getTime = () => {
        fetch("http://localhost:3000/api/booking")
          .then((response) => response.json())
          .then((data) => data)
      };
    

    
    </script>
  </body>
</html>
 -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin</title>
  <link rel="stylesheet" href="vet.css">
  <link href="adminBookings.html" rel="import" />
  <script src='https://kit.fontawesome.com/a076d05399.js'></script>
</head>


<body>
  <h2 class="header">Bookings</h2>
  <br>
  <div class="spinner-border" role="status" id="loading">


  </div>

  <table id="table" class="container">
  </table>

  <!--  ID<input class="fields" name="add_ids" id="add_ids" cols="30" rows="10"></input> -->
  <input placeholder="Pet Name" class="fields" name="add_pet" id="add_pet"></input>
  <input class="fields" placeholder="Reason of visit" name="add_reason" id="add_reason"></input>
  <input class="fields" placeholder="Owner Name" name="add_name" id="add_name"></input>
  <input type="date" class="fields" placeholder="Date" name="add_time" id="add_time"></input>
  <i id="table" onclick="addUser(add_ids, add_pet, add_reason, add_name, add_time);"><i class='fa fa-plus'
      style='font-size:26px;color:#FB667A'></i></td></i>

  <br><br><br><br>



  <script>
    const api_url =
      "http://localhost:3000/api/booking/";

    async function getapi(url) {
      const response = await fetch(url);
      var data = await response.json();
      console.log(data);
      if (response) {
        hideloader();
      }
      show(data);
    }

    getapi(api_url);


    function hideloader() {
      document.getElementById('loading').style.display = 'none';
    }

    function show(data) {
      let tab =
        `<tr>
          <th>Pet ID</th>
          <th>Pet Name</th>
          <th>Reason</th>
          <th>Pet Owner</th>
          <th>Date</th>
          <th>Delete</th>

          </tr>`;
      for (let r of data) {

        tab += `<tr>
      <td>${r._id} </td>
      <td>${r.pet} </td>
      <td>${r.reason}</td>
      <td>${r.fullName}</td>
      <td>${r.time}</td>
     
   
       <td><i class='fas fa-trash-alt' style='font-size:26px;color:#FB667A' onclick="deleteUser('${r._id}')"></i></td>
     
  </tr>`;
      }

      // Setting innerHTML as tab variable
      document.getElementById("table").innerHTML = tab;
    }



    const getAddDataFromUI = () => {

      // userData._id = document.getElementById("add_id").value
      /*   userData.id = document.getElementById("add_ids").value; */
      const userData = new Object();
      userData._id = document.getElementById("add_ids").value;
      userData.pet = document.getElementById("add_pet").value;
      userData.reason = document.getElementById("add_reason").value;
      userData.fullName = document.getElementById("add_name").value;
      userData.time = document.getElementById("add_date").value;
      return userData;

    }


    const getUsers = () => {
      fetch("/api/booking")
        .then((response) => response.json())
        .then((data) => data);
    };


    function addUser() {
      const addData = getAddDataFromUI();
      fetch("/api/booking/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(addData),
      }).then((response) => getusers());
    }

    const deleteUser = (_id) => {
      fetch("http://localhost:3000/api/booking/" + _id, {
        method: "DELETE",
      });
      getusers();
    };

  </script>
</body>

</html>
</body>

</html>